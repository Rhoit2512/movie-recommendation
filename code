import pandas as pd
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics.pairwise import cosine_similarity

# 1. Load your dataset (using a sample structure)
def get_recommendations(movie_title, df):
    # 2. Vectorize the 'overview' or 'genres' column using TF-IDF
    # This converts text into a numerical format for comparison
    tfidf = TfidfVectorizer(stop_words='english')
    tfidf_matrix = tfidf.fit_transform(df['description'])

    # 3. Compute the Cosine Similarity matrix
    # This measures the angle between vectors to find "closeness"
    cosine_sim = cosine_similarity(tfidf_matrix, tfidf_matrix)

    # 4. Get index of the movie that matches the title
    indices = pd.Series(df.index, index=df['title']).drop_duplicates()
    idx = indices[movie_title]

    # 5. Get pairwise similarity scores of all movies with that movie
    sim_scores = list(enumerate(cosine_sim[idx]))

    # 6. Sort movies based on similarity scores
    sim_scores = sorted(sim_scores, key=lambda x: x[1], reverse=True)

    # 7. Get the scores of the 5 most similar movies
    sim_scores = sim_scores[1:6]
    movie_indices = [i[0] for i in sim_scores]

    return df['title'].iloc[movie_indices]

# Example usage with dummy data
data = {
    'title': ['The Dark Knight', 'Inception', 'Interstellar', 'The Avengers', 'Toy Story'],
    'description': [
        'A gritty superhero story about a masked vigilante in Gotham.',
        'A professional thief steals secrets through the use of dream-sharing technology.',
        'A team of explorers travel through a wormhole in space to ensure humanity survival.',
        'Earth mightiest heroes must come together to stop an alien invasion.',
        'A cowboy doll and a space ranger lead a group of toys on an adventure.'
    ]
}

df_movies = pd.DataFrame(data)
print("Recommendations for 'Inception':")
print(get_recommendations('Inception', df_movies))
